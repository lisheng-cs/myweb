import{d as E,r as _,o as N,c as b,a as e,w as s,b as n,e as g,E as u,f as i,g as w,h as R,i as c,j,k as y,u as m,B as x,F,l as M,t as f,_ as V}from"./index-h4lH79Q9.js";import{f as I}from"./TimeParse-Dn2ZSm0v.js";const O={class:"top10-history"},S={class:"header"},q=E({__name:"Dashboard",setup(z){const h=_([]),d=_(!1),p=_(!1);async function k(){d.value=!0;try{const a=await g.post("http://47.102.118.235:8101/api/watch_history/top10");h.value=a.data.data}catch(a){console.error(a),u.error("获取热门电影失败")}finally{d.value=!1}}async function D(){p.value=!0;try{const a=await g.get("http://47.102.118.235:5000/generate_feature_csv",{responseType:"blob"}),l=URL.createObjectURL(a.data),r=document.createElement("a");r.href=l,r.download="training_data.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(l),u.success("训练数据导出成功")}catch(a){console.error(a),u.error("导出训练数据失败")}finally{p.value=!1}}return N(k),(a,l)=>{const r=n("el-button"),o=n("el-table-column"),B=n("el-image"),C=n("el-tag"),L=n("el-table"),T=n("el-card"),U=j("loading");return i(),b("div",O,[e(T,{shadow:"hover"},{default:s(()=>[w("div",S,[l[1]||(l[1]=w("span",{class:"title"},"当前热门电影 Top 10",-1)),e(r,{type:"primary",loading:p.value,onClick:D},{default:s(()=>l[0]||(l[0]=[c(" 导出训练数据 ")])),_:1},8,["loading"])]),R((i(),y(L,{data:h.value,stripe:"",style:{width:"100%","margin-top":"20px"}},{default:s(()=>[e(o,{prop:"id",label:"ID",width:"60"}),e(o,{label:"海报",width:"100"},{default:s(({row:t})=>[e(B,{src:m(x)+t.poster,fit:"cover",style:{width:"60px",height:"90px"},"preview-src-list":[m(x)+t.poster],"preview-teleported":!0},null,8,["src","preview-src-list"])]),_:1}),e(o,{prop:"title",label:"中文名","min-width":"120"}),e(o,{prop:"original_title",label:"原名","min-width":"120"}),e(o,{label:"类型","min-width":"140"},{default:s(({row:t})=>[(i(!0),b(F,null,M(t.genres||[],v=>(i(),y(C,{key:v.id,type:"info",class:"tag"},{default:s(()=>[c(f(v.genreName),1)]),_:2},1024))),128))]),_:1}),e(o,{label:"上映日期",width:"120"},{default:s(({row:t})=>[c(f(m(I)(t.release_date)),1)]),_:1}),e(o,{label:"平均评分",width:"100"},{default:s(({row:t})=>[c(f(t.vote_count?(t.vote_sum/t.vote_count).toFixed(1):"-"),1)]),_:1}),e(o,{prop:"runtime",label:"时长(分钟)",width:"120"})]),_:1},8,["data"])),[[U,d.value]])]),_:1})])}}}),H=V(q,[["__scopeId","data-v-9bc5ccdc"]]);export{H as default};
